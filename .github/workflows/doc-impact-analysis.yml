name: Documentation Impact Analysis

on:
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review]
    paths:
      # Source code changes that might affect documentation
      - "src/**/*.ts"
      - "src/**/*.js"
      - "!src/**/*.test.ts"
      - "!src/**/*.spec.ts"
      - "!src/**/*.d.ts"
      # Documentation changes to ensure they stay indexed
      - "docs/**/*.md"
      - "README.md"
      # Configuration changes that affect CI behavior
      - "gistdex.config.ts"
      - ".github/workflows/doc-impact-analysis.yml"
      - ".github/workflows/reusable-doc-impact.yml"

jobs:
  analyze-docs:
    # Skip for draft PRs to save resources
    if: github.event.pull_request.draft == false
    uses: ./.github/workflows/reusable-doc-impact.yml
    with:
      doc-paths: "docs/**/*.md,README.md,CLAUDE.md"
      threshold: "0.7"
      node-version: "24.2.0"
      gistdex-version: "latest"
      post-pr-comment: true
      add-label: false
      label-name: "documentation-impact"
    secrets:
      GOOGLE_GENERATIVE_AI_API_KEY: ${{ secrets.GOOGLE_GENERATIVE_AI_API_KEY }}
